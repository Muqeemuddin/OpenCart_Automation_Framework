version: '3'



services:

  selenium-hub:

    image: selenium/hub
    platform: linux/amd64

    ports:

      - "4442-4444:4442-4444"

    networks:

      - grid



  node-chrome:

    image: selenium/node-chrome
    platform: linux/amd64

    environment:

      - SE_EVENT_BUS_HOST=selenium-hub

      - SE_EVENT_BUS_PUBLISH_PORT=4442

      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      
      - SE_NODE_MAX_SESSIONS=3                 # allow 5 sessions in parallel
      
      - SE_NODE_OVERRIDE_MAX_SESSIONS=true 

    networks:

      - grid



  node-firefox:

    image: selenium/node-firefox
    platform: linux/amd64

    environment:

      - SE_EVENT_BUS_HOST=selenium-hub

      - SE_EVENT_BUS_PUBLISH_PORT=4442

      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      
      - SE_NODE_MAX_SESSIONS=3                 # allow 5 sessions in parallel
      
      - SE_NODE_OVERRIDE_MAX_SESSIONS=true 

    networks:

      - grid
     

      



networks:

  grid:

    driver: bridge